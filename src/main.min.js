import{auth}from"./js/fb.min";import{}from"xlsx";import{loadExcel}from"./js/excel.min";import{signInWithEmailAndPassword,onAuthStateChanged}from"firebase/auth";import"./style.min.css";document.addEventListener("DOMContentLoaded",(function(){const loadingEl=document.getElementById("loading"),contentEl=document.getElementById("content");onAuthStateChanged(auth,(async user=>{let loginFormEl;if(loadingEl.remove(),user){loginFormEl=document.getElementById("loginForm"),loginFormEl&&loginFormEl.remove(),contentEl.style.display="block";try{const response=await fetch("/pages/excel.html"),html=await response.text();contentEl.innerHTML=html,loadExcel()}catch(error){console.error("Error loading content:",error),contentEl.innerHTML="Error loading content"}}else contentEl.style.display="none",loginFormEl=document.getElementById("loginForm"),loginFormEl||(loadingEl.remove(),function(){const loginForm=document.createElement("div");loginForm.id="loginForm",loginForm.className="container",loginForm.innerHTML='\n      <h2>Login</h2>\n      <form id="login">\n        <div class="form-group">\n          <label for="email">Email</label>\n          <input type="email" id="email" required />\n        </div>\n        <div class="form-group">\n          <label for="password">Password</label>\n          <input type="password" id="password" required />\n        </div>\n        <button type="submit" class="btn">Login</button>\n      </form>\n    ',document.body.appendChild(loginForm),document.getElementById("login").addEventListener("submit",(e=>{e.preventDefault();const email=document.getElementById("email").value,password=document.getElementById("password").value;signInWithEmailAndPassword(auth,email,password).catch((error=>{alert("Error: "+error.message)}))}))}())}))}));