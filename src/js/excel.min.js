import $ from"jquery";import"datatables.net-buttons";import"datatables.net-buttons-dt";import"datatables.net-buttons/js/buttons.html5.min.js";import{handleError}from"./utils/utils.min.js";import DataTable from"datatables.net-dt";async function loadInventory(){try{const loadingMessage=document.getElementById("loadingMessage");if(loadingMessage){try{loadingMessage.innerHTML='<img src="/assets/loading.gif" alt="Cargando..." /> Cargando...'}catch(error){loadingMessage.textContent="Cargando...",console.warn("Loading image could not be displayed:",error)}loadingMessage.style.display="block"}const[{extractName:extractName,extractPeriod:extractPeriod,extractInventoryData:extractInventoryData,extractTotals:extractTotals},{displayInventoryTable:displayInventoryTable}]=await Promise.all([import("./utils/excelite.min.js"),import("./display/inventory.min.js")]),response=await fetch(`assets/${import.meta.env.VITE_INVENTORY_FILE}`);if(!response.ok)throw new Error("No se pudo cargar el archivo Excel");const arrayBuffer=await response.arrayBuffer(),data=new Uint8Array(arrayBuffer),workbook=XLSX.read(data,{type:"array"}),sheet=workbook.Sheets[workbook.SheetNames[0]];displayInventoryTable({name:extractName(sheet),period:extractPeriod(sheet),data:extractInventoryData(sheet),totals:extractTotals(sheet)})}catch(error){handleError(error,"Error al cargar los datos")}finally{const loadingMessage=document.getElementById("loadingMessage");loadingMessage&&(loadingMessage.style.display="none",loadingMessage.innerHTML="")}}async function loadCatalog(){try{const loadingMessage=document.getElementById("loadingMessage");if(loadingMessage){try{loadingMessage.innerHTML='<img src="/assets/loading.gif" alt="Cargando..." /> Cargando...'}catch(error){loadingMessage.textContent="Cargando...",console.warn("Loading image could not be displayed:",error)}loadingMessage.style.display="block"}const[{extractCatalogData:extractCatalogData},{displayCatalogTable:displayCatalogTable}]=await Promise.all([import("./utils/excelite.min.js"),import("./display/catalog.min.js")]),response=await fetch(`/assets/${import.meta.env.VITE_CATALOG_FILE}`);if(!response.ok)throw new Error("No se pudo cargar el catálogo");const arrayBuffer=await response.arrayBuffer(),data=new Uint8Array(arrayBuffer),workbook=XLSX.read(data,{type:"array"}),sheet=workbook.Sheets[workbook.SheetNames[0]];displayCatalogTable(extractCatalogData(sheet))}catch(error){handleError(error,"Error al cargar los datos del catálogo")}finally{const loadingMessage=document.getElementById("loadingMessage");loadingMessage&&(loadingMessage.style.display="none",loadingMessage.innerHTML="")}}$.DataTable=DataTable;export{loadInventory,loadCatalog};